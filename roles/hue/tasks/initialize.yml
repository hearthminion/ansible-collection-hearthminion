---
- name: "Prompt User to press physical button on Hue Hub."
  ansible.builtin.pause:
    prompt: "Press the button on the hub now..."
  delegate_to: localhost
  become: no

- name: "Grab unique username."
  ansible.builtin.uri:
    url: "http://{{ inventory_hostname }}/api"
    method: POST
    body: '{{ __body_info | to_json}}'
  register: username_info
  delegate_to: localhost
  become: no

#  - name: PRINT DATA TO TERMINAL WINDOW
#    debug:
#      var: username_info.json
# - lineinfile:
#     path: "./username_info.yml"
#     regexp: '^username'
#     insertafter: EOF
#     line: 'username: {{username_info.json[0]["success"]["username"]}}'
